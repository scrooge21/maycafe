<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MayCafe</title>
    
    <!-- Telegram & Firebase SDKs -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    
    <!-- CSS Styles -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/chat.css">
    <link rel="stylesheet" href="css/cart.css">
    <link rel="stylesheet" href="css/profile-admin.css">
    <link rel="stylesheet" href="css/modals.css">
    <link rel="stylesheet" href="css/tests.css"> <!-- –°—Ç–∏–ª–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ -->
    
    <!-- Fonts / Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700;800&display=swap" rel="stylesheet">

    <!-- Cropper.js -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>

</head>
<body>

    <!-- –≠–ö–†–ê–ù –ó–ê–ì–†–£–ó–ö–ò -->
    <div id="loading-screen">
        <img src="https://i.ibb.co/1tN0WX3g/1000020877.png" class="loader-logo" alt="Loading">
    </div>

    <!-- HEADER (–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è –≥–ª–∞–≤–Ω–æ–π) -->
    <div class="fixed-header-wrapper">
        <header class="main-header">
            <div class="banner-content">
                <div id="adminBannerEdit" class="admin-banner-edit" onclick="editBanner()" style="display:none;">
                    <span class="material-symbols-rounded">edit</span>
                </div>
                <div class="banner-row">
                    <img src="https://i.ibb.co/1tN0WX3g/1000020877.png" class="banner-logo-img" alt="Logo">
                    <div class="banner-text-info"><h1>MayCafe</h1><p>–¢–≤–æ–π —É—é—Ç–Ω—ã–π —Ñ–∞–Ω-—à–æ–ø</p></div>
                </div>
                <div class="banner-deco">‚ú®</div>
            </div>
        </header>
    </div>

    <!-- –ö–û–ù–¢–ï–ô–ù–ï–† –í–ö–õ–ê–î–û–ö -->
    <div id="main-swiper" class="swiper-container">
        
        <!-- 1. –ì–õ–ê–í–ù–ê–Ø -->
        <div id="tab-home" class="tab-content">
            <div style="height: 110px;"></div> 
            <div class="stories-container">
                <div class="story-item" onclick="showPopup('–ù–æ–≤–∏–Ω–∫–∞', '–ü–æ–ø—Ä–æ–±—É–π –Ω–∞—à –Ω–æ–≤—ã–π –ª–∞—Ç—Ç–µ!')">
                    <div class="story-ring new"><img src="https://cdn-icons-png.flaticon.com/512/2553/2553691.png" alt=""></div><span>New</span>
                </div>
                <!-- –ö–ù–û–ü–ö–ê –¢–ï–°–¢–û–í -->
                <div class="story-item" onclick="openTestHub()">
                    <div class="story-ring" style="background: linear-gradient(45deg, #ff9eb5, #a240c9); color: white;">
                        <span class="material-symbols-rounded" style="font-size:28px;">psychology_alt</span>
                    </div><span>–¢–µ—Å—Ç—ã</span>
                </div>
                <div class="story-item" onclick="promptPromo()">
                    <div class="story-ring promo"><img src="https://cdn-icons-png.flaticon.com/512/879/879757.png" alt=""></div><span>Promo</span>
                </div>
                <div class="story-item" onclick="openVideoModal()">
                    <div class="story-ring youtube"><img src="https://cdn-icons-png.flaticon.com/512/1384/1384060.png" alt=""></div><span>YouTube</span>
                </div>
                <div class="story-item" onclick="Telegram.WebApp.openTelegramLink('https://t.me/mayshot')">
                    <div class="story-ring"><img src="https://cdn-icons-png.flaticon.com/512/2111/2111646.png" alt=""></div><span>–ö–∞–Ω–∞–ª</span>
                </div>
                <div class="story-item" onclick="showPopup('–°–∫–æ—Ä–æ', '–†–∞–∑–¥–µ–ª –ò–≤–µ–Ω—Ç—ã –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ üìÖ')">
                    <div class="story-ring"><img src="https://cdn-icons-png.flaticon.com/512/7653/7653930.png" alt=""></div><span>–ò–≤–µ–Ω—Ç—ã</span>
                </div>
            </div>
            <h3>–ü–æ–ø—É–ª—è—Ä–Ω–æ–µ üî•</h3>
            <div class="menu-grid" id="featuredGrid"><p style="padding:0 15px; color:#999">–ó–∞–≥—Ä—É–∑–∫–∞...</p></div>
            <div class="heart-gradient-footer"></div>
        </div>

        <!-- 2. –ú–ï–ù–Æ -->
        <div id="tab-menu" class="tab-content">
            <div class="banner-content" style="border-radius: 0 0 25px 25px; margin-bottom: 20px;">
                <div class="admin-banner-edit" onclick="editBanner()" style="display:none;"><span class="material-symbols-rounded">edit</span></div>
                <div class="banner-row">
                    <img src="https://i.ibb.co/1tN0WX3g/1000020877.png" class="banner-logo-img" alt="Logo">
                    <div class="banner-text-info"><h1>MayCafe</h1><p>–ú–µ–Ω—é</p></div>
                </div>
                <div class="banner-deco">‚ú®</div>
            </div>
            <div class="menu-nav-row">
                <button class="search-icon-btn" onclick="openSearchModal()"><span class="material-symbols-rounded">search</span></button>
                <div class="nav-scroller" id="categoryNav"></div>
            </div>
            <div class="menu-grid" id="menuContainer"></div>
            <div class="heart-gradient-footer"></div>
        </div>

        <!-- 3. –ü–û–î–î–ï–†–ñ–ö–ê -->
        <div id="tab-support" class="tab-content" style="height: 100vh; display:flex; flex-direction:column;">
            <div style="height: 100px; flex-shrink: 0;"></div> 
            <div style="flex: 1; display: flex; flex-direction: column; overflow: hidden; position: relative;">
                <div id="adminChatListView" style="display:none; height: 100%; flex-direction: column;">
                    <h3 style="padding: 0 15px;">–°–æ–æ–±—â–µ–Ω–∏—è</h3>
                    <div id="adminChatList" class="chat-list-container"></div>
                </div>
                <div id="chatConversationView" class="chat-container">
                    <div id="chatHeaderAdmin" class="chat-header-bar" style="display:none;">
                        <button onclick="backToChatList()"><span class="material-symbols-rounded">arrow_back</span></button>
                        <div class="chat-user-info"><span id="chatHeaderName" style="font-weight:bold; font-size:16px;">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</span><span style="font-size:12px; opacity:0.7; color:var(--primary);">–≤ —Å–µ—Ç–∏</span></div>
                    </div>
                    <div id="chatHistoryArea" class="chat-history"><div class="chat-placeholder">–ó–∞–≥—Ä—É–∑–∫–∞...</div></div>
                    <div class="chat-input-area">
                        <button class="attach-btn"><span class="material-symbols-rounded">attach_file</span></button>
                        <input type="text" id="chatInput" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ...">
                        <button class="send-btn" onclick="handleSend()"><span class="material-symbols-rounded">arrow_upward</span></button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 4. –ü–†–û–§–ò–õ–¨ -->
        <div id="tab-profile" class="tab-content">
            <div style="height: 110px;"></div>
            <div class="profile-header">
                <img id="userAvatar" src="https://placehold.co/100x100/ff9eb5/white?text=Foto" class="avatar-img" alt="Avatar">
                <div>
                    <h2 id="userName">–ì–æ—Å—Ç—å</h2>
                    <p class="user-status" onclick="editUserStatus()"><span id="statusText">–õ—é–±–∏—Ç–µ–ª—å –∫–æ—Ñ–µ ‚òïÔ∏è</span><span class="material-symbols-rounded edit-icon">edit</span></p>
                </div>
            </div>
            <div class="settings-list">
                <div class="setting-item" onclick="openMyOrders()">
                    <span class="material-symbols-rounded icon">receipt_long</span><span class="label">–ú–æ–∏ –∑–∞–∫–∞–∑—ã</span><span class="material-symbols-rounded" style="margin-left:auto; color:var(--gray)">chevron_right</span>
                </div>
                <div id="adminOrdersBtn" class="setting-item" onclick="openAdminOrders()" style="display:none; border-color:var(--primary);">
                    <span class="material-symbols-rounded icon" style="color:var(--primary)">list_alt</span><span class="label">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</span>
                </div>
                <div id="adminStatsBtn" class="setting-item" onclick="openStats()" style="display:none; border-color:var(--primary);">
                    <span class="material-symbols-rounded icon" style="color:var(--primary)">equalizer</span><span class="label">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                </div>
                <div class="setting-item">
                    <span class="material-symbols-rounded icon">dark_mode</span><span class="label">–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</span>
                    <label class="switch"><input type="checkbox" id="themeToggle" onchange="toggleTheme()"><span class="slider round"></span></label>
                </div>
            </div>
        </div>
    </div> 

    <!-- FLOAT BUTTONS -->
    <div id="floatingCart" class="floating-cart-btn" onclick="toggleCart(true)"></div>
    <div id="adminAddFab" class="admin-fab" onclick="openAddProduct()"><span class="material-symbols-rounded">add</span></div>

    <!-- MODALS -->
    <!-- Cart -->
    <div id="cartPage" class="cart-overlay">
        <div class="cart-sheet">
            <div class="cart-header"><span class="material-symbols-rounded close-icon" onclick="toggleCart(false)">expand_more</span><h2>–ö–æ—Ä–∑–∏–Ω–∞</h2><span class="material-symbols-rounded delete-icon" onclick="clearCartConfirm()">delete</span></div>
            <div id="cartList" class="cart-list"></div>
            <div class="cart-extras-dodo">
                <div class="promo-trigger" onclick="promptPromo()">–í–≤–µ—Å—Ç–∏ –ø—Ä–æ–º–æ–∫–æ–¥</div>
                <div class="cart-summary-list">
                    <div class="summary-row"><span id="itemsCountText">0 —Ç–æ–≤–∞—Ä–æ–≤</span><span id="subTotal">0 ‚ÇΩ</span></div>
                    <div class="summary-row discount-row" id="discountRow" style="display:none"><span>–°–∫–∏–¥–∫–∏</span><span id="discountVal">0 ‚ÇΩ</span></div>
                    <div class="summary-row"><span>MayCoins</span><span style="color:var(--primary)">+5 üíé</span></div>
                </div>
                <button class="action-btn checkout-btn-dodo" onclick="checkout()"><span id="finalBtnText">–û–§–û–†–ú–ò–¢–¨ –ó–ê 0 ‚ÇΩ</span></button>
            </div>
        </div>
    </div>

    <!-- Checkout -->
    <div id="checkoutScreen" class="fullscreen-modal" style="display:none;">
        <div class="checkout-header"><button onclick="closeCheckout()"><span class="material-symbols-rounded">arrow_back</span></button><h2>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</h2><div style="width:24px"></div></div>
        <div class="checkout-content">
            <div class="checkout-block"><h3 class="ch-title">–ì–¥–µ –≤—ã?</h3><div class="checkout-address">MayCafe, —É–ª. –§–∞–Ω–¥–æ–º–Ω–∞—è, 1</div></div>
            <div class="checkout-block"><h3 class="ch-title">–°–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è</h3><div class="method-grid"><div class="method-card active" onclick="selectMethod(this, 'table')"><span class="material-symbols-rounded">table_restaurant</span><span>–ó–∞ —Å—Ç–æ–ª–∏–∫</span></div><div class="method-card" onclick="selectMethod(this, 'takeaway')"><span class="material-symbols-rounded">shopping_bag</span><span>–° —Å–æ–±–æ–π</span></div></div></div>
            <div class="checkout-block"><h3 class="ch-title">–û–ø–ª–∞—Ç–∞</h3><div class="payment-list"><div class="payment-option active" onclick="selectPayment(this, 'stars')"><span class="material-symbols-rounded" style="color:#FFD700">star</span><span>Telegram Stars</span></div><div class="payment-option" onclick="selectPayment(this, 'card')"><span class="material-symbols-rounded" style="color:#4CAF50">credit_card</span><span>–ö–∞—Ä—Ç–∞ (Test)</span></div></div></div>
            <div class="checkout-block"><h3 class="ch-title">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</h3><input type="text" id="orderComment" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ø–æ–±–æ–ª—å—à–µ –∫–æ—Ä–∏—Ü—ã..." class="checkout-input"></div>
        </div>
        <div class="checkout-footer"><div class="checkout-total"><span>–ò—Ç–æ–≥–æ:</span><span id="checkoutTotalPrice">0 ‚ÇΩ</span></div><button class="pay-btn" onclick="confirmPayment()">–û–ø–ª–∞—Ç–∏—Ç—å <span class="material-symbols-rounded">check</span></button></div>
    </div>

    <!-- Order History Modals -->
    <div id="myOrdersModal" class="fullscreen-modal" style="display:none;"><div class="checkout-header"><button onclick="document.getElementById('myOrdersModal').style.display='none'"><span class="material-symbols-rounded">close</span></button><h2>–ú–æ–∏ –∑–∞–∫–∞–∑—ã</h2><div style="width:24px"></div></div><div id="myOrdersList" class="orders-list-container"></div></div>
    <div id="adminOrdersModal" class="fullscreen-modal" style="display:none;"><div class="checkout-header"><button onclick="document.getElementById('adminOrdersModal').style.display='none'"><span class="material-symbols-rounded">close</span></button><h2>–í—Å–µ –∑–∞–∫–∞–∑—ã</h2><div style="width:24px"></div></div><div id="adminOrdersList" class="orders-list-container"></div></div>
    <div id="adminStatsModal" class="fullscreen-modal" style="display:none;"><div class="checkout-header"><button onclick="document.getElementById('adminStatsModal').style.display='none'"><span class="material-symbols-rounded">close</span></button><h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2><div style="width:24px"></div></div><div id="statsLoader" style="padding:40px; text-align:center;">–ó–∞–≥—Ä—É–∑–∫–∞...</div><div id="statsContent" class="stats-wrapper" style="display:none;"></div></div>

    <!-- Detail -->
    <div id="productDetailModal" class="detail-overlay"><button class="detail-close-btn" onclick="closeProductDetail()">‚úï</button><div class="detail-content"><img id="dImg" src="" class="detail-img" alt="Product"><div class="detail-info"><h2 id="dName">–ù–∞–∑–≤–∞–Ω–∏–µ</h2><p id="dDesc">–û–ø–∏—Å–∞–Ω–∏–µ...</p></div></div><div class="detail-bottom" id="detailBtnContainer"></div></div>

    <!-- Admin Product Panel -->
    <div id="adminPanel" class="admin-overlay">
        <div class="admin-card"><div class="admin-card-header"><h3 id="adminFormTitle">–¢–æ–≤–∞—Ä</h3><button onclick="toggleAdmin()" class="close-btn-styled">‚úï</button></div>
            <div class="admin-scroll-area">
                <input type="hidden" id="pId"><div class="input-group"><label>–ù–∞–∑–≤–∞–Ω–∏–µ *</label><input type="text" id="pName"></div><div class="input-group"><label>–û–ø–∏—Å–∞–Ω–∏–µ</label><textarea id="pDesc" rows="2"></textarea></div>
                <div class="input-group half"><div><label>–¶–µ–Ω–∞ *</label><input type="number" id="pPrice"></div><div><label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label><input type="text" id="pCat" list="catList"><datalist id="catList"></datalist></div></div>
                <div class="input-group" style="display:flex;gap:15px;margin-top:10px;padding:10px;background:rgba(0,0,0,0.03);border-radius:10px;"><label class="switch-label" style="display:flex;align-items:center;gap:8px;flex:1"><input type="checkbox" id="pSoldOut"><span style="font-size:13px;font-weight:600">üö´ Sold Out</span></label><label class="switch-label" style="display:flex;align-items:center;gap:8px;flex:1"><input type="checkbox" id="pHidden"><span style="font-size:13px;font-weight:600">üëÅÔ∏è‚Äçüó®Ô∏è –°–∫—Ä—ã—Ç—ã–π</span></label></div>
                <div class="input-group"><label>–ú–µ—Ç–∫–∞</label><select id="pBadge" class="admin-select"><option value="">–ë–µ–∑ –º–µ—Ç–∫–∏</option><option value="new">New</option><option value="hot">Hot</option><option value="sale">Sale</option><option value="hit">Hit</option></select></div>
                <div class="input-group"><label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</label><div class="admin-upload-box" onclick="document.getElementById('pFile').click()"><span class="material-symbols-rounded" style="font-size:24px;color:var(--primary)">add_a_photo</span><span id="uploadText" style="font-size:12px">–ó–∞–≥—Ä—É–∑–∏—Ç—å</span><input type="file" id="pFile" style="display:none" accept="image/*"></div><input type="text" id="pImg" placeholder="–∏–ª–∏ —Å—Å—ã–ª–∫–∞" style="margin-top:5px;font-size:11px"></div>
            </div>
            <div class="admin-actions"><button onclick="deleteProduct()" id="btnDelete" class="delete-btn" style="display:none"><span class="material-symbols-rounded">delete</span></button><button onclick="saveProduct()" class="save-btn" id="saveBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button></div>
        </div>
    </div>

    <!-- Popups -->
    <div id="customPopup" class="popup-overlay" onclick="closePopup()"><div class="popup-card"><h3 id="popupTitle"></h3><p id="popupText"></p><button onclick="closePopup()">–û–ö</button></div></div>
    <div id="customConfirm" class="popup-overlay"><div class="popup-card"><h3 id="confirmTitle"></h3><p id="confirmText"></p><div class="confirm-actions"><button onclick="closeConfirm(false)" class="cancel-btn">–û—Ç–º–µ–Ω–∞</button><button onclick="closeConfirm(true)" class="ok-btn">–î–∞</button></div></div></div>
    <div id="videoModal" class="video-overlay"><div class="video-header"><span>MayTube</span><button onclick="closeVideoModal()">‚úï</button></div><div class="video-wrapper"><div class="video-frame-container"><iframe id="youtubePlayer" src="" title="YouTube" frameborder="0" allowfullscreen></iframe></div><div class="video-info"><h2>Video</h2></div></div></div>
    <div id="searchModal" class="search-overlay"><div class="search-header"><button onclick="closeSearchModal()" class="back-btn"><span class="material-symbols-rounded">arrow_back</span></button><div class="search-input-wrapper"><span class="material-symbols-rounded search-placeholder-icon">search</span><input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫..." oninput="handleSearch(this.value)"><span class="material-symbols-rounded clear-icon" onclick="clearSearch()" style="display:none">cancel</span></div></div><div class="search-content"><div id="searchTagsBlock"><h4 style="margin:10px 0 15px;opacity:0.7;font-weight:600">–ü–æ–ø—É–ª—è—Ä–Ω–æ–µ</h4><div class="tags-container" id="popularTagsContainer"></div></div><div id="searchResultsGrid" class="menu-grid" style="margin-top:20px"></div></div></div>
    <div id="bannerEditModal" class="fullscreen-modal" style="display:none;z-index:2500"><div class="checkout-header"><button onclick="closeBannerEditor()"><span class="material-symbols-rounded">close</span></button><h2>–û–±–ª–æ–∂–∫–∞</h2><button onclick="document.getElementById('bannerInput').click()" style="color:var(--primary);font-weight:bold"><span class="material-symbols-rounded">add_photo_alternate</span></button><input type="file" id="bannerInput" accept="image/*" style="display:none" onchange="handleBannerFileSelect(this)"></div><div class="crop-area-wrapper" style="flex:1;background:#000;position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center"><img id="bannerCropImage" style="max-width:100%;display:none" alt="Crop"><div id="cropPlaceholder" style="color:#666;text-align:center"><span class="material-symbols-rounded" style="font-size:48px;display:block;margin-bottom:10px">image</span>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ç–æ</div></div><div class="checkout-footer"><button id="saveBannerBtn" class="pay-btn" onclick="saveBannerCrop()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±–ª–æ–∂–∫—É <span class="material-symbols-rounded">check</span></button></div></div>
    <div id="promoModal" class="popup-overlay"><div class="popup-card"><h3>–ü—Ä–æ–º–æ–∫–æ–¥</h3><input type="text" id="promoInput" class="checkout-input" placeholder="MAY10" style="text-align:center;font-weight:bold;letter-spacing:1px;text-transform:uppercase"><div class="confirm-actions"><button onclick="closePromoModal()" class="cancel-btn">–û—Ç–º–µ–Ω–∞</button><button onclick="applyPromoCode()" class="ok-btn">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button></div></div></div>

    <!-- ========================= -->
    <!-- –ú–û–î–£–õ–¨ –¢–ï–°–¢–û–í (–ù–û–í–´–ô) -->
    <!-- ========================= -->
    
    <!-- 1. Test Hub -->
    <div id="testHub" class="tests-overlay">
        <div class="tests-header">
            <button onclick="closeTestHub()" style="background:none; border:none; padding:5px;"><span class="material-symbols-rounded" style="font-size:24px">arrow_back</span></button>
            <h2 style="margin-left:10px;">Play & Match</h2>
            <!-- –ê–≤–∞—Ç–∞—Ä–∫–∞ (–∫–ª–∏–∫–∞–±–µ–ª—å–Ω–∞ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è) -->
            <img id="hubUserAvatar" src="" class="hub-avatar" onclick="openTestProfile()" onerror="this.src='https://placehold.co/100?text=U'" alt="User">
        </div>
        <div class="test-hub-content">
            <div class="room-promo-card">
                <div class="rpc-content"><h3>–ü–∞—Ä–Ω—ã–π —Ä–µ–∂–∏–º</h3><p>–ü—Ä–æ–π–¥–∏ —Ç–µ—Å—Ç —Å –¥—Ä—É–≥–æ–º</p><div class="rpc-btns"><button onclick="openRoomLobby('create')">–°–æ–∑–¥–∞—Ç—å</button><button onclick="openRoomLobby('join')" class="outline">–í–æ–π—Ç–∏</button></div></div><div class="rpc-icon">üë©‚Äç‚ù§Ô∏è‚Äçüë®</div>
            </div>
            <div style="display:flex; justify-content:space-between; align-items:center; margin: 20px 20px 10px;">
                <h3 style="margin:0; padding:0;">–í—Å–µ —Ç–µ—Å—Ç—ã</h3>
                <button id="adminCreateTestBtn" onclick="openTestCreator()" style="display:none; color:var(--primary); font-weight:bold; background:none; border:none;">+ –°–æ–∑–¥–∞—Ç—å</button>
            </div>
            <div id="testsListContainer" class="tests-list"></div>
        </div>
    </div>

    <!-- 2. Test Profile (–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ) -->
    <div id="testProfile" class="tests-overlay" style="z-index: 3100;">
        <div class="tests-header"><button onclick="closeTestProfile()" style="background:none;border:none"><span class="material-symbols-rounded">close</span></button><h2>–¢–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h2><button onclick="saveTestProfile()" style="color:var(--primary);font-weight:bold;background:none;border:none">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button></div>
        <div style="padding: 30px 20px; display:flex; flex-direction:column; align-items:center;">
            <div class="profile-avatar-upload" onclick="document.getElementById('profileAvatarInput').click()">
                <img id="profilePreview" src="https://placehold.co/150?text=Ava" alt="Ava"><div class="pau-overlay"><span class="material-symbols-rounded">photo_camera</span></div><input type="file" id="profileAvatarInput" hidden accept="image/*" onchange="handleProfileAvatar(this)">
            </div>
            <div class="input-group" style="width:100%; margin-top:30px;"><label>–¢–≤–æ–µ –∏–º—è (–Ω–∏–∫–Ω–µ–π–º)</label><input type="text" id="profileNameInput" class="checkout-input" placeholder="–ö–∞–∫ —Ç–µ–±—è –Ω–∞–∑—ã–≤–∞—Ç—å?"></div>
        </div>
    </div>

    <!-- 3. Room Lobby -->
    <div id="roomLobby" class="tests-overlay">
        <div class="tests-header"><button onclick="leaveRoom()" style="background:none;border:none"><span class="material-symbols-rounded">arrow_back</span></button><h2 id="roomTitle">–ö–æ–º–Ω–∞—Ç–∞</h2></div>
        <div id="roomWaiting" style="padding:30px 20px; text-align:center; display:flex; flex-direction:column; height:100%;">
            <div class="room-code-box"><span style="font-size:12px;color:var(--gray);text-transform:uppercase">–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã</span><h1 id="roomCodeDisplay" style="font-size:48px;margin:5px 0;letter-spacing:5px">----</h1><p style="font-size:13px;color:var(--primary)">–ù–∞–∂–º–∏, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</p></div>
            <div class="room-players-grid" id="roomPlayersList"></div>
            <div style="margin-top:auto;">
                <div id="roomHostControls" style="display:none;">
                    <p style="margin-bottom:10px;font-size:13px;color:var(--gray);text-align:left;font-weight:bold">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ—Å—Ç:</p>
                    <select id="roomTestSelect" class="room-select-styled"></select>
                    <button class="pay-btn" onclick="startRoomGame()" style="margin-top:15px">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                </div>
                <div id="roomGuestStatus" style="display:none;color:var(--gray)">–û–∂–∏–¥–∞–µ–º –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞...</div>
            </div>
        </div>
        <div id="roomJoinInput" style="display:none;padding:40px 20px;flex-direction:column;align-items:center;"><h3>–í–≤–µ–¥–∏ –∫–æ–¥ –∫–æ–º–Ω–∞—Ç—ã</h3><input type="text" id="joinCodeInput" class="checkout-input" style="text-align:center;font-size:24px;letter-spacing:5px;text-transform:uppercase;margin:20px 0;" placeholder="ABCD" maxlength="4"><button class="pay-btn" onclick="joinRoomByCode()">–í–æ–π—Ç–∏</button></div>
    </div>

    <!-- 4. Room Results -->
    <div id="roomResultScreen" class="tests-overlay">
        <div class="tests-header"><button onclick="leaveRoom()" style="background:none;border:none"><span class="material-symbols-rounded">close</span></button><h2>–†–µ–∑—É–ª—å—Ç–∞—Ç</h2></div>
        <div style="flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px;text-align:center;"><div class="coop-score-circle"><span id="coopPercent">0%</span></div><h2 style="margin:20px 0 10px">–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</h2><p id="coopMessage" style="color:var(--gray);max-width:250px">–°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –æ—Ç–≤–µ—Ç—ã...</p></div>
    </div>

    <!-- 5. Test Player -->
    <div id="testPlayer" class="tests-overlay">
        <div class="test-player" style="display:flex;">
            <div class="tp-stats-bar" id="tpStatsBar" style="display:none"><div class="tp-timer" id="tpTimer"></div><div class="tp-lives" id="tpLives"></div></div>
            <div class="tp-progress"><div id="tpBar" class="tp-bar"></div></div>
            <div class="tp-content">
                <div id="tpQuestionText" class="tp-question">–í–æ–ø—Ä–æ—Å...</div>
                <div id="tpOptionsCont" class="tp-options"></div>
            </div>
        </div>
    </div>

    <!-- 6. Test Results (Solo) -->
    <div id="testResultsView" class="tests-overlay">
        <div class="test-results" style="display:flex;">
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –Ω–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            <div id="matchList" class="match-list"></div>
        </div>
    </div>

    <!-- 7. Advanced Test Creator (Admin) -->
    <div id="testCreator" class="tests-overlay">
        <div class="tests-header">
            <button onclick="openTestHub()" style="background:none;border:none"><span class="material-symbols-rounded">close</span></button>
            <h2>–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç</h2>
            <button onclick="saveNewTest()" style="color:var(--primary);font-weight:bold;background:none;border:none">OK</button>
        </div>
        <div class="test-creator" style="display:flex;">
            <div class="tc-content">
                <!-- Cover Upload -->
                <div class="creator-cover-upload" onclick="document.getElementById('tcCoverInput').click()">
                    <img id="tcCoverPreview" src="" alt="">
                    <span class="material-symbols-rounded" style="font-size:32px">add_photo_alternate</span>
                    <input type="file" id="tcCoverInput" hidden accept="image/*" onchange="handleCoverUpload(this)">
                </div>
                
                <!-- Mode Selector -->
                <div class="type-selector">
                    <div class="type-opt active" data-mode="quiz" onclick="setCreatorMode('quiz')">üèÜ –í–∏–∫—Ç–æ—Ä–∏–Ω–∞</div>
                    <div class="type-opt" data-mode="match" onclick="setCreatorMode('match')">‚ù§Ô∏è –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</div>
                </div>

                <div class="input-group"><label>–ù–∞–∑–≤–∞–Ω–∏–µ</label><input type="text" id="tcTitle" class="checkout-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞"></div>
                <div class="input-group"><label>–û–ø–∏—Å–∞–Ω–∏–µ</label><input type="text" id="tcDesc" class="checkout-input" placeholder="–ö–æ—Ä–æ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ"></div>
                
                <div class="creator-settings-row">
                    <div class="input-group"><label>–¢–∞–π–º–µ—Ä (—Å–µ–∫)</label><input type="number" id="tcTimer" class="checkout-input" placeholder="0 = –≤—ã–∫–ª"></div>
                    <div class="input-group"><label>–ñ–∏–∑–Ω–∏</label><input type="number" id="tcLives" class="checkout-input" placeholder="‚àû"></div>
                </div>
                
                <h3 style="margin:20px 0 10px 0">–í–æ–ø—Ä–æ—Å—ã</h3>
                <div id="tcQuestions" data-mode="quiz"></div>
                <button class="checkout-btn-dodo" onclick="addCreatorQuestion()" style="background:var(--card);color:var(--text);border:1px solid var(--border);margin-top:10px">+ –í–æ–ø—Ä–æ—Å</button>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('home', this)"><span class="material-symbols-rounded">home</span></div>
        <div class="nav-item" onclick="switchTab('menu', this)"><span class="material-symbols-rounded">bakery_dining</span></div>
        <div class="nav-item" onclick="switchTab('support', this)"><span class="material-symbols-rounded">chat</span></div>
        <div class="nav-item" onclick="switchTab('profile', this)"><span class="material-symbols-rounded">person</span></div>
    </nav>

    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/state.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/menu.js"></script>
    <script src="js/cart.js"></script>
    <script src="js/chat.js"></script>
    <script src="js/profile.js"></script>
    <script src="js/admin.js"></script>
    <script src="js/tests.js"></script>
    <script src="js/main.js"></script>
</body>
</html>